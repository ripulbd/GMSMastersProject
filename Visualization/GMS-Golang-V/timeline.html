<!DOCTYPE html>

<html>

<head>
    
<title>Glasgow Memory Server (GMS)</title>
    
<!--meta(name='description', content='website description')-->
    
<!--meta(name='keywords', content='website keywords, website keywords')-->
    
<meta content="text/html; charset=utf-8" http-equiv="content-type">
    
<link href="/resources/stylesheets/timeline.css" rel="stylesheet" type="text/css">

<script type="text/javascript" src="/resources/javascripts/jquery.js" ></script>
    
<script src="resources/javascripts/modernizr-1.5.min.js" type="text/javascript"></script>

<script type="text/javascript" src="/resources/javascripts/jquery.tx3-tag-cloud.js" ></script>

<script>
var scrollHandler = function(a,b){
					if($(window).scrollTop() == $(document).height() - $(window).height()) {
						showRemainedLowLevelTopics(a,b);
					}	
		};

function getSubTopic(name){
	$.get("/subtags?tagname="+name, "", function(data, status) {
	//var ul=document.createElement('ul');
	var element = document.getElementById("submenu");
	//check high level
	var highlevel = document.getElementById(data.Name+"HighLevel");	
		while (element.firstChild) {
			element.removeChild(element.firstChild);
		}

		//add previous
		if(highlevel == null){
			var li=document.createElement("li");
			var a = document.createElement("a");
			a.setAttribute("href","#");
			a.onclick = (function(name){ 
				return  function(){
					getSubTopic(name);
				};
			})(data.ParentName);		
			li.appendChild(a);
			var linkText = document.createTextNode("\u23CE");
			a.appendChild(linkText);
			element.appendChild(li);
		}
		
		var i;
		for(i in data.SubTopics){
			var li=document.createElement("li");
			var a = document.createElement("a");
			a.setAttribute("id",data.SubTopics[i].Name);
			a.setAttribute("href","#");
			a.onclick= (function(name){ 
				return  function(){
					getSubTopic(name);
				};
			})(data.SubTopics[i].Name);
			li.appendChild(a);
			var linkText = document.createTextNode(data.SubTopics[i].Name);
			a.appendChild(linkText);
			element.appendChild(li);
		}
		showKeywords(data);
	})
}

function showKeywords(topic){
	var element = document.getElementById("tagcloud");
	while (element.firstChild) {
		element.removeChild(element.firstChild);
	}
	document.getElementById("keywordname").innerHTML = topic.Name;
	var i;
	var link = document.getElementById("tagcloud");
	if(!topic.Keywords){ 
      link.style.border = "none";
	}
	else {
	for (i in topic.Keywords){ 
	    link.style.border = "3px solid #2F4F4F";
		link.style.borderRadius = "10px";
		link.style.MozBorderRadius = "10px";
		link.style.padding = "20px";
		var li=document.createElement("li");
		li.setAttribute("data-weight",topic.Keywords[i].Weight);  
		var a = document.createElement("a");
		a.setAttribute("id",topic.Keywords[i].Name);
		a.setAttribute("href","#");
		a.onclick = (function(name){
		           return function(){
				 showLowLevelTopics(name);
			   };
			 })(topic.Keywords[i].Name);
		li.appendChild(a);
		var linkText = document.createTextNode(topic.Keywords[i].Name);
		a.appendChild(linkText);
		element.appendChild(li);
	 }
	$("#tagcloud").tx3TagCloud({
		multiplier: 2
	});
	}
}


function showLowLevelTopics(keyword){
  $.get("/showlist?keyword="+keyword, "", function(data, status) {  
   var i;
     var el = document.getElementById("lowleveltopics");
     while(el.firstChild){
		el.removeChild(el.firstChild);
	 }
	 var max = data.NewGroups.length;
	 if( max > 5 ){
		max = 5;
		var current = 5;
		$(window).scroll(function() {
			if($(window).scrollTop() == $(document).height() - $(window).height()) {
				if( data.NewGroups.length > current){
				   showRemainedLowLevelTopics(data,current);
				   current = current + 5;
				}
			}
		});
	 }
    //for(i in data.NewGroups){
    for(i = 0; i < max; i++){
	  //big box creation  
	   //na fugw to ul apo e3w kai na dhmiourghsw ena ul edw
	   var ul = document.createElement("ul");
	   ul.style.border = "3px solid #2F4F4F";
	   ul.style.borderRadius = "10px";
	   ul.style.MozBorderRadius = "10px";
	   ul.style.padding = "10px";
	   var p_intro = document.createElement("p");
	   var p_value = document.createTextNode("SUMMARY:");
	   p_intro.appendChild(p_value);
	   ul.appendChild(p_intro);
	   el.appendChild(ul);
	   //small box creation in which the summary will be shown
	    var iDiv = document.createElement("div");
	   iDiv.setAttribute("id","summary");
	   //paragraph creation for the summary
	   var newElement = document.createElement("p");
	   iDiv.appendChild(newElement);
	   //text creation inside the paragraph
	   var summaryText = document.createTextNode(data.NewGroups[i].Summary);
	   //var summaryText = document.createTextNode("summary");
	   newElement.appendChild(summaryText);
	   ul.appendChild(iDiv);
	   var j;
	  for(j in data.NewGroups[i].News){
	   //for(j=0; j < 2; j++){
         var li = document.createElement("li");
         var a = document.createElement("a");
	     var linkText = document.createTextNode(data.NewGroups[i].News[j].Title);
		 //var linkText = document.createTextNode("Title1 is about education news and business and has a lot of subnews!!");
		 a.appendChild(linkText);
         a.setAttribute("href","/indiNews?url="+data.NewGroups[i].News[j].Url);
		 a.setAttribute("target","_blank");
         li.appendChild(a);
         ul.appendChild(li);
        } 
    }
  })
}

function showRemainedLowLevelTopics(data,index){
	var max = data.NewGroups.length;
	 if( max > 5 + index ){
		max = 5 + index;
		
	 }
    var el = document.getElementById("lowleveltopics");
    for(i = index; i < max; i++){
	  //big box creation  
	   //na fugw to ul apo e3w kai na dhmiourghsw ena ul edw
	   var ul = document.createElement("ul");
	   ul.style.border = "3px solid #2F4F4F";
	   ul.style.borderRadius = "10px";
	   ul.style.MozBorderRadius = "10px";
	   ul.style.padding = "10px";
	   var p_intro = document.createElement("p");
	   var p_value = document.createTextNode("SUMMARY:");
	   p_intro.appendChild(p_value);
	   ul.appendChild(p_intro);
	   el.appendChild(ul);
	   //small box creation in which the summary will be shown
	    var iDiv = document.createElement("div");
	   iDiv.setAttribute("id","summary");
	   //paragraph creation for the summary
	   var newElement = document.createElement("p");
	   iDiv.appendChild(newElement);
	   //text creation inside the paragraph
	   var summaryText = document.createTextNode(data.NewGroups[i].Summary);
	   //var summaryText = document.createTextNode("summary");
	   newElement.appendChild(summaryText);
	   ul.appendChild(iDiv);
	   var j;
	  for(j in data.NewGroups[i].News){
	   //for(j=0; j < 2; j++){
         var li = document.createElement("li");
         var a = document.createElement("a");
	     var linkText = document.createTextNode(data.NewGroups[i].News[j].Title);
		 //var linkText = document.createTextNode("Title1 is about education news and business and has a lot of subnews!!");
		 a.appendChild(linkText);
         a.setAttribute("href","/indiNews?url="+data.NewGroups[i].News[j].Url);
		 a.setAttribute("target","_blank");
         li.appendChild(a);
         ul.appendChild(li);
        } 
    }
}


</script>

</head>

<body>  
<div id="main">
        
<header>
            
<div id="logo">
                
<div id="logo_text">
                    
<!--class="logo_colour", allows you to change the colour of the text -->

                    
<h1><a href="index.html">Glasgow Memory Server(GMS)</a></h1>
                
</div>
            
</div>           
            
               
<div id="menu_container" style="height: 63px">
                    
<ul id="menu-bar" style="left: 0px; top: 18px">
 
{{range $index, $element := .SubTopics}}  
<li id={{$element.Name}}HighLevel>                       
   <a id={{$element.Name}} onclick="getSubTopic({{$element.Name}})" href="#" >{{printf "%s" $element.Name}}</a>
</li>
{{end}}
                                            
</ul>

<div id="menu-bar" style="left: 0px; top: 5px">
 
	<div id="submenu">
	</div>
                                            
</div>    
                
</div>

</header>

</div>


<div id="content" style="height:80%">
<div class ="tagC">
  <h2 id="keywordname" style = "width:45%"></h2>
	<ul id="tagcloud" style="width:50%;">
	</ul>
</div>

<div class = "lowlevellist">
   <h2 id="keyword" style = "width:45%"></h2>
   <div id="lowleveltopics"></div>
</div>
</div>       	
</body>
</html>

